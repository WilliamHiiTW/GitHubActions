name: Create and Process XML File on PR

on:
  pull_request:
    paths:
      - '**/*'

jobs:
  process-file:
    runs-on: macos-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
      with:
        fetch-depth: 2

    - name: Create XML File
      run: echo '<root><data>Some content</data></root>' > example.xml

    - name: Read file contents
      id: read_file
      uses: andstor/file-reader-action@v1
      with:
        path: "example.xml"

    - name: Process File
      run: |
        file_path="example.xml"
        # Check if the file has been modified
        if git diff --name-only -r HEAD^1 HEAD | grep -q "^example.xml$"; then
          echo "::set-output name=boolVariable::true"
        else
          echo "::set-output name=boolVariable::false"
        fi
      id: process-file

    - name: Comment on PR
      if: steps.process-file.outputs.boolVariable == 'true'
      uses: actions/github-script@v7
      with:
        script: |
          const readContent = `${{ steps.read_file.outputs.contents }}`;
          github.rest.issues.createComment({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: readContent
          })
